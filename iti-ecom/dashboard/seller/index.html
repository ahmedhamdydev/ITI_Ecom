<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />

    <meta
      name="viewport"
      content="height=device-height, 
                      width=device-width, initial-scale=1.0, 
                      minimum-scale=1.0, maximum-scale=1.0, 
                      user-scalable=no"
    />

    <title>Seller Dashboard</title>

    <link
      rel="stylesheet"
      type="text/css"
      href="../assets/css/bootstrap.min.css"
    />

    <link
      rel="stylesheet"
      type="text/css"
      href="../assets/css/fontAwesome.css"
    />

    <link rel="stylesheet" type="text/css" href="../assets/css/main.css" />
  </head>

  <body>
    <div class="root-wrapper">
      <aside class="sidebar">
        <div class="slidebar-content">
          <a class="logoBox" href="#"> Our E-com</a>
          <ul class="sidebar-list">
            <li>
              <a class="active" href="index.html">
                <i class="fa-solid fa-house"></i>
                home
              </a>
            </li>
            <li>
              <a href="products.html">
                <i class="fa-solid fa-list"></i>
                products
              </a>
            </li>
            <li>
              <a href="orders.html">
                <i class="fa-solid fa-cart-shopping"></i>
                orders
              </a>
            </li>
            <li>
              <a href="sales.html">
                <i class="fa-solid fa-chart-line"></i>
                sales
              </a>
            </li>
            <li>
              <a href="profile.html">
                <i class="fa-solid fa-user"></i>
                profile
              </a>
            </li>
          </ul>
        </div>
        <a class="logout-link" href="#">
          <i class="fa-solid fa-arrow-right-from-bracket"></i>
          logout
        </a>
        <div class="close-sidebar" id="sidebar-close">
          <i class="fas fa-times"></i>
        </div>
      </aside>
      <main class="page-wrapper">
        <nav class="top-nav">
          <div class="container-fluid w-100 h-100">
            <div class="nav-content">
              <div class="nav-menu">
                <button class="btn open-sidebar" id="sidebar-open">
                  <i class="fa-solid fa-bars"></i>
                </button>
              </div>
              <div class="nav-actions">
                <a
                  class="account-btn"
                  href="profile.html"
                  aria-expanded="false"
                >
                  <img
                    src="../assets/img/avatar.png"
                    class="admin-avatar ml-4"
                  />
                  <span class="user-name" id="userName"> </span>
                </a>
              </div>
            </div>
          </div>
        </nav>

        <section class="section-style home-section">
          <div class="container-fluid">
            <h1 class="main-title">home</h1>
            <div class="statistics-boxes mb-5">
              <div class="row row-cols-xxl-3 row-cols-lg-2 gy-3">
                <div class="row-col">
                  <div class="box-item">
                    <div class="item-icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 576 512"
                      >
                        <path
                          d="M64 80c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H512c8.8 0 16-7.2 16-16V96c0-8.8-7.2-16-16-16H64zM0 96C0 60.7 28.7 32 64 32H512c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zm96 64a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm104 0c0-13.3 10.7-24 24-24H448c13.3 0 24 10.7 24 24s-10.7 24-24 24H224c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24H448c13.3 0 24 10.7 24 24s-10.7 24-24 24H224c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24H448c13.3 0 24 10.7 24 24s-10.7 24-24 24H224c-13.3 0-24-10.7-24-24zm-72-64a32 32 0 1 1 0-64 32 32 0 1 1 0 64zM96 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"
                        />
                      </svg>
                    </div>
                    <div class="item-texts">
                      <p class="no" id="products_no"></p>
                      <p class="title">products</p>
                    </div>
                  </div>
                </div>
                <div class="row-col">
                  <div class="box-item">
                    <div class="item-icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="77.858"
                        height="54.351"
                        viewBox="0 0 77.858 54.351"
                      >
                        <path
                          id="Path_19681"
                          data-name="Path 19681"
                          d="M70.62,60.215H25.406l-8.32-34.348H67.957l-1.379,4.922H23.758L29.7,55.3H66.325l9.2-38.312H94.945v4.917H79.823ZM40.391,66.747A4.808,4.808,0,0,1,35.4,71.34a4.606,4.606,0,1,1,0-9.18A4.8,4.8,0,0,1,40.391,66.747Zm26.1,0a5.01,5.01,0,1,1-5-4.587A4.808,4.808,0,0,1,66.5,66.747Z"
                          transform="translate(-17.087 -16.988)"
                        ></path>
                      </svg>
                    </div>
                    <div class="item-texts">
                      <p class="no" id="orders_no"></p>
                      <p class="title">orders</p>
                    </div>
                  </div>
                </div>
                <div class="row-col">
                  <div class="box-item">
                    <div class="item-icon">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        height="800px"
                        width="800px"
                        version="1.0"
                        id="Layer_1"
                        viewBox="0 0 24 24"
                        enable-background="new 0 0 24 24"
                        xml:space="preserve"
                      >
                        <g>
                          <path
                            d="M22.5,8H22V7.5C22,6.7,21.3,6,20.5,6H20V5.5C20,4.7,19.3,4,18.5,4h-17C0.7,4,0,4.7,0,5.5v10C0,16.3,0.7,17,1.5,17H2v0.5   C2,18.3,2.7,19,3.5,19H4v0.5C4,20.3,4.7,21,5.5,21h17c0.8,0,1.5-0.7,1.5-1.5v-10C24,8.7,23.3,8,22.5,8z M1,15.5v-10   C1,5.2,1.2,5,1.5,5h17C18.8,5,19,5.2,19,5.5v10c0,0.3-0.2,0.5-0.5,0.5h-17C1.2,16,1,15.8,1,15.5z M3,17.5V17h15.5   c0.8,0,1.5-0.7,1.5-1.5V7h0.5C20.8,7,21,7.2,21,7.5v10c0,0.3-0.2,0.5-0.5,0.5h-17C3.2,18,3,17.8,3,17.5z M23,19.5   c0,0.3-0.2,0.5-0.5,0.5h-17C5.2,20,5,19.8,5,19.5V19h15.5c0.8,0,1.5-0.7,1.5-1.5V9h0.5C22.8,9,23,9.2,23,9.5V19.5z"
                          ></path>
                          <path
                            d="M17.5,8C16.7,8,16,7.3,16,6.5C16,6.2,15.8,6,15.5,6h-11C4.2,6,4,6.2,4,6.5C4,7.3,3.3,8,2.5,8C2.2,8,2,8.2,2,8.5v4   C2,12.8,2.2,13,2.5,13C3.3,13,4,13.7,4,14.5C4,14.8,4.2,15,4.5,15h11c0.3,0,0.5-0.2,0.5-0.5c0-0.8,0.7-1.5,1.5-1.5   c0.3,0,0.5-0.2,0.5-0.5v-4C18,8.2,17.8,8,17.5,8z M12,10.5c0,1.9-0.9,3.5-2,3.5s-2-1.6-2-3.5S8.9,7,10,7S12,8.6,12,10.5z M3,12.1   V8.9C4,8.8,4.8,8,4.9,7h3.2C7.4,7.8,7,9.1,7,10.5s0.4,2.7,1.1,3.5H4.9C4.8,13,4,12.2,3,12.1z M17,12.1c-1,0.2-1.8,1-2,1.9h-3.2   c0.7-0.8,1.1-2.1,1.1-3.5S12.6,7.8,11.9,7H15c0.2,1,1,1.8,2,1.9V12.1z"
                          ></path>
                        </g>
                      </svg>
                    </div>
                    <div class="item-texts">
                      <p class="no">
                        <span id="sales_no"></span>
                        <small class="fs-5">EGP</small>
                      </p>
                      <p class="title">sales</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="orders">
              <h1 class="main-title">Latest orders</h1>
              <div class="table-responsive">
                <table class="table table-hover border">
                  <thead class="bg-light">
                    <tr>
                      <th>id</th>
                      <th>order owner</th>
                      <th>price</th>
                      <th>order status</th>
                      <th>payment method</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody id="orders_table_body" class="latest"></tbody>
                </table>
              </div>
            </div>
          </div>
        </section>

        <div
          class="modal fade"
          id="orderModal"
          tabindex="-1"
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="productModalLabel">
                  order details
                </h1>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body py-4">
                <div class="order-details-columns">
                  <div class="row gx-3">
                    <div class="col-lg-12 mb-4">
                      <div class="details-box">
                        <h5 class="details-title mb-3">Products</h5>
                        <div class="table-responsive order-table">
                          <table class="table table-hover border">
                            <thead>
                              <tr id="modal_products_table_head_tr"></tr>
                            </thead>
                            <tbody id="modal_products_table_body"></tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-12">
                      <div class="details-box">
                        <h5 class="details-title mb-3 pb-3 border-bottom">
                          bill Info
                        </h5>
                        <div
                          class="bill-items row row-cols-sm-2"
                          id="modal_bill_info"
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-bs-dismiss="modal"
                >
                  Close
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- jquery 3.5.1   -->
    <script src="../assets/js/jquery-3.5.1.min.js"></script>

    <!-- bootstrap v5   -->
    <script src="../assets/js/bootstrap.bundle.min.js"></script>

    <!-- main style js   -->
    <script src="../assets/js/main.js"></script>

    <!-- sellerAuth script   -->
    <script src="../assets/js/scripts/sellerAuth.js"></script>

    <!-- orders script   -->
    <script src="../assets/js/scripts/orders.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        getHomeStatistics();
      });
      function getHomeStatistics() {
       
        const userData = JSON.parse(localStorage.getItem("userData"));
        const productsList =
          JSON.parse(localStorage.getItem("productsList")) || [];
        const ordersList = JSON.parse(localStorage.getItem("ordersList")) || [];

        let products = productsList.filter((el) => el.seller.id == userData.id);
        let orders = ordersList.filter(
          (el) => el.sellerId == userData.id && el.totalOrderPrice > 0
        );

        const total_sales = orders.reduce(
          (sum, order) => (sum += Number(order.totalOrderPrice)),
          0
        );

        console.log(ordersList);

        $("#products_no").text(products.length);
        $("#orders_no").text(orders.length);
        $("#sales_no").text(total_sales);
      }
    </script>

    <!-- <script>
      const userData = JSON.parse(localStorage.getItem("userData"));
      const ordersList = JSON.parse(localStorage.getItem("ordersList")) || [];
      const ordersTableBody = document.getElementById("orders_table_body");

      const renderTable = () => {
        ordersTableBody.innerHTML = "";
        let orders;
        if (userData.role === "seller") {
          orders = ordersList.filter((el) => el.orderOwner == userData.id);
        } else if (userData.role === "admin") {
          orders = ordersList;
        } else {
          orders = [];
        }

        if (ordersTableBody.classList.contains("latest")) {
          orders = orders.slice(0, 10);
        }

        if (orders.length === 0) {
          const tr = document.createElement("tr");
          tr.innerHTML = `
              <td colspan="6" class="text-center">No orders found</td>
            `;
          ordersTableBody.appendChild(tr);
          return;
        }

        orders.forEach((order) => {
          const row = document.createElement("tr");

          row.innerHTML = `
                      <td>${order.id}</td>
                      <td>${order.billDetails.name}</td>
                      <td>${order.totalOrderPrice}</td>
                      <td><span class="${
                        order.orderStatus === "processing"
                          ? "text-info"
                          : order.orderStatus === "shipped"
                          ? "text-success"
                          : order.orderStatus === "canceled"
                          ? "text-danger"
                          : ""
                      }">${order.orderStatus}</span></td>
                      <td>${order.paymentMethodType}</td>
                      <td>
                        <div class="table-actions">
                              <button type="button" class="btn btn-info btn-view" data-id="${
                                order.id
                              }" onclick="showOrderDetails(${order.id})">
                                <i class="fa-solid fa-eye"></i>
                              </button>
                              ${
                                order.orderStatus === "processing"
                                  ? `
                                  <button type="button" class="btn btn-success btn-ship" data-id="${order.id}" onclick="changeOrderStatus(${order.id}, 'shipped')">
                                    <i class="fa-solid fa-check"></i>
                                  </button>
                                  <button type="button" class="btn btn-danger btn-cancel" data-id="${order.id}" onclick="changeOrderStatus(${order.id}, 'canceled')">
                                    <i class="fa-solid fa-xmark"></i>
                                  </button>`
                                  : ""
                              }
                            </div>

                      </td>
                    `;

          ordersTableBody.appendChild(row);
        });
      };

      const showOrderDetails = (id) => {
        const order = ordersList.find((o) => o.id == id);
        const modalProductsTableBody = document.getElementById(
          "modal_products_table_body"
        );
        const modalBillInfo = document.getElementById("modal_bill_info");

        modalProductsTableBody.innerHTML = "";
        order.products.forEach((product) => {
          const row = document.createElement("tr");
          row.innerHTML = `
              <td>${product.product.name}</td>
              <td>${product.product.price} EGP</td>
              <td>${product.count}</td>
              <td>${
                Number(product.product.price) * Number(product.count)
              } EGP</td>
            `;
          modalProductsTableBody.appendChild(row);
        });

        modalBillInfo.innerHTML = `
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-regular fa-id-card"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Order No</p>
                    <p class="title">#${order.id}</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-solid fa-money-bill-wave"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Order Price</p>
                    <p class="title">${order.totalOrderPrice} EGP</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-solid fa-user"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Name</p>
                    <p class="title">${order.billDetails.name}</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-solid fa-phone"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Phone</p>
                    <p class="title">${order.billDetails.phone}</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-regular fa-credit-card"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Payment Method</p>
                    <p class="title">${order.paymentMethodType}</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-solid fa-chart-bar"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Order Status</p>
                    <p class="title ${
                      order.orderStatus === "processing"
                        ? "text-info"
                        : order.orderStatus === "shipped"
                        ? "text-success"
                        : order.orderStatus === "canceled"
                        ? "text-danger"
                        : ""
                    }">${order.orderStatus}</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-solid fa-location-dot"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Address</p>
                    <p class="title">${order.billDetails.address}</p>
                  </div>
                </div>
                <div class="bill-item">
                  <div class="item-icon"><i class="fa-solid fa-calendar-week"></i></div>
                  <div class="item-texts">
                    <p class="sub-title">Order Date</p>
                    <p class="title">${order.createdAt}</p>
                  </div>
                </div>
              `;

        $("#orderModal").modal("show");
      };

      const changeOrderStatus = (orderId, status) => {
        const order = ordersList.find((o) => o.id == orderId);
        if (order) {
          order.orderStatus = status;
          localStorage.setItem("ordersList", JSON.stringify(ordersList));
          renderTable();
        }
      };

      document.addEventListener("DOMContentLoaded", () => {
        renderTable();
      });
    </script> -->
  </body>
</html>
